<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Master ∫ Test</title>
    <link rel="icon" type="image/x-icon" href="imagen/LogoA.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        purple: {
                            light: '#a78bfa',
                            DEFAULT: '#7c3aed',
                            dark: '#5b21b6',
                            darker: '#4c1d95'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .hero-gradient {
            background: linear-gradient(135deg, #5b21b6 0%, #7c3aed 100%);
        }
        .lesson-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(91, 33, 182, 0.3), 0 10px 10px -5px rgba(91, 33, 182, 0.1);
        }
        .math-symbol {
            font-family: "Cambria Math", serif;
        }
        .test-option:hover {
            background-color: #f3f4f6;
        }
        .correct {
            background-color: #d1fae5;
            border-color: #10b981;
        }
        .incorrect {
            background-color: #fee2e2;
            border-color: #ef4444;
        }
        .hidden {
            display: none;
        }
        .completed-topic {
            border-left: 4px solid #7c3aed;
        }
        .answered {
            background-color: #e9d5ff;
        }
    </style>
</head>
<body class="bg-purple-50">
    <!-- Página Principal -->
    <div id="main-page">
        <!-- Header -->
        <header class="hero-gradient text-white shadow-lg">
            <div class="container mx-auto px-6 py-16 text-center">
                <h1 class="text-4xl md:text-6xl font-bold mb-6">The Master ∫ Test</h1>
                <p class="text-xl md:text-2xl mb-8">Domina el cálculo integral con nuestros cursos especializados</p>
                <button onclick="scrollToTopics()" class="bg-white text-purple-800 font-bold py-3 px-8 rounded-full hover:bg-purple-100 transition duration-300 transform hover:scale-105">
                    Comenzar a aprender
                </button>
                <button onclick="window.location.href='juegos.php'" class="bg-white text-purple-800 font-bold py-3 px-8 rounded-full hover:bg-purple-100 transition duration-300 transform hover:scale-105">
                    Volver a juegos 
                </button>
            </div>
        </header>

        <!-- Temas del Curso -->
        <section id="topics" class="container mx-auto px-6 py-12">
            <h2 class="text-3xl font-bold text-center text-purple-800 mb-12">Temario del Curso</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Generamos los 20 temas -->
                <script>
                    const topics = [
                        "INTEGRALES INDEFINIDAS / INTEGRALES INMEDIATAS",
                        "INTEGRALES INMEDIATAS E INTEGRALES CON PASOS ALGEBRAICOS",
                        "INTEGRALES INDEFINIDAS CON CAMBIOS DE VARIABLE",
                        "INTEGRACIÓN DE LA FUNCIÓN EXPONENCIAL",
                        "INTEGRALES INDEFINIDAS / TRIGONOMÉTRICAS",
                        "INTEGRALES INDEFINIDAS EN UNA MISMA INTEGRAL",
                        "INTEGRALES INDEFINIDAS / INTEGRACIÓN POR PARTES",
                        "MÉTODOS DE INTEGRACIÓN, SUSTITUCIÓN TRIGONOMÉTRICA",
                        "INTEGRACIÓN CON EL MÉTODO FRACCIONES PARCIALES 1",
                        "INTEGRACIÓN CON EL MÉTODO FRACCIONES PARCIALES 2",
                        "INTEGRACIÓN CON EL MÉTODO FRACCIONES PARCIALES 3",
                        "INTEGRACIÓN CON EL MÉTODO FRACCIONES PARCIALES 4",
                        "INTEGRALES ESPECIALES",
                        "INTEGRALES ESPECIALES (Avanzado)",
                        "INTEGRAL DEFINIDA CON CAMBIO DE VARIABLE",
                        "APLICACIONES / ÁREA BAJO LA CURVA",
                        "APLICACIONES / ÁREA ENTRE DOS FUNCIONES",
                        "APLICACIONES / SÓLIDOS DE REVOLUCIÓN",
                        "APLICACIONES / SÓLIDOS DE REVOLUCIÓN, FÓRMULAS DE VOLUMEN",
                        "APLICACIONES A LA FÍSICA / TIRO VERTICAL"
                    ];

                    topics.forEach((topic, index) => {
                        document.write(`
                            <div id="topic-${index + 1}" class="lesson-card bg-white rounded-xl shadow-md overflow-hidden transition duration-300">
                                <div class="p-6">
                                    <div class="flex items-center mb-4">
                                        <div class="bg-purple-100 text-purple-800 rounded-full w-10 h-10 flex items-center justify-center mr-4">
                                            <span class="font-bold">${index + 1}</span>
                                        </div>
                                        <h3 class="text-xl font-bold text-purple-800">${topic}</h3>
                                    </div>
                                    <p class="text-gray-600 mb-4">${getTopicDescription(index)}</p>
                                    <button onclick="startTopicTest(${index + 1})" class="text-purple-600 font-semibold hover:text-purple-800 transition duration-300">
                                        Ver 20 preguntas →
                                    </button>
                                </div>
                            </div>
                        `);
                    });

                    function getTopicDescription(index) {
                        const descriptions = [
                            "Aprende las bases de las integrales indefinidas y las técnicas más simples.",
                            "Domina las manipulaciones algebraicas necesarias para resolver integrales.",
                            "Aprende la poderosa técnica de sustitución para resolver integrales complejas.",
                            "Integración de funciones exponenciales y sus variantes.",
                            "Domina las integrales que involucran funciones trigonométricas.",
                            "Resuelve integrales que combinan múltiples técnicas en un mismo problema.",
                            "Aprende a aplicar la integración por partes en diversos casos.",
                            "Domina las sustituciones trigonométricas para integrales con radicales.",
                            "Descompone en fracciones simples con factores lineales distintos.",
                            "Aprende a manejar factores lineales repetidos en fracciones parciales.",
                            "Resuelve integrales con factores cuadráticos irreducibles.",
                            "Combina diferentes tipos de descomposición en fracciones parciales.",
                            "Explora técnicas especiales y trucos para integrales complejas.",
                            "Enfrenta problemas avanzados que requieren múltiples técnicas.",
                            "Aplica cambios de variable en el contexto de integrales definidas.",
                            "Calcula áreas bajo curvas usando integrales definidas.",
                            "Determina áreas entre dos curvas mediante integración.",
                            "Aprende el método del disco para sólidos de revolución.",
                            "Domina los métodos de la arandela y capas cilíndricas.",
                            "Aplica el cálculo integral a problemas de física como el tiro vertical."
                        ];
                        return descriptions[index];
                    }
                </script>

                <!-- Test Final -->
                <div class="lesson-card bg-purple-800 text-white rounded-xl shadow-md overflow-hidden transition duration-300">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="bg-purple-200 text-purple-800 rounded-full w-10 h-10 flex items-center justify-center mr-4">
                                <span class="font-bold">★</span>
                            </div>
                            <h3 class="text-xl font-bold text-white">TEST FINAL INTEGRAL</h3>
                        </div>
                        <p class="text-purple-200 mb-4">Demuestra todo lo que has aprendido con 100 preguntas de todos los temas.</p>
                        <button id="final-test-btn" class="bg-purple-200 text-purple-800 font-semibold py-2 px-4 rounded-full opacity-50 cursor-not-allowed" disabled>
                            Completa todos los temas primero
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-purple-900 text-white py-12">
            <div class="container mx-auto px-6">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-6 md:mb-0">
                        <h3 class="text-2xl font-bold">The Master ∫ Test</h3>
                        <p class="mt-2 text-purple-200">Domina el cálculo integral paso a paso</p>
                    </div>
                    <div class="flex space-x-6">
                        <a href="terminos.php" class="hover:text-purple-300 transition duration-300">Términos</a>
                        <a href="_CON.php" class="hover:text-purple-300 transition duration-300">Contacto</a>
                    </div>
                </div>
                <div class="border-t border-purple-800 mt-8 pt-8 text-center text-purple-300">
                    <p> 2025 Re∫olve_App - Todos los derechos reservados</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Página de Test -->
    <div id="test-page" class="hidden container mx-auto px-6 py-12">
        <div class="max-w-4xl mx-auto">
            <button onclick="backToMain()" class="mb-6 flex items-center text-purple-600 hover:text-purple-800 transition duration-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                </svg>
                Volver al temario
            </button>
            
            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-6 border-b border-gray-200 bg-purple-50">
                    <h2 id="test-title" class="text-2xl font-bold text-purple-800"></h2>
                    <div class="flex justify-between items-center mt-2">
                        <span id="test-progress" class="text-sm text-purple-600 font-medium"></span>
                        <span id="test-timer" class="text-sm text-purple-600 font-medium">Tiempo: 00:00</span>
                    </div>
                    <!-- Barra de progreso -->
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mt-4">
                        <div id="progress-bar" class="bg-purple-600 h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="question-container" class="p-6">
                    <!-- Las preguntas se cargarán aquí dinámicamente -->
                </div>
                
                <div class="p-4 bg-gray-50 flex justify-between items-center">
                    <div>
                        <button id="prev-btn" onclick="prevQuestion()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-300 disabled:opacity-50">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-1" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            Anterior
                        </button>
                    </div>
                    
                    <!-- Indicador de preguntas respondidas -->
                    <div id="answered-count" class="text-sm text-gray-600">
                        0 de 0 respondidas
                    </div>
                    
                    <div>
                        <button id="next-btn" onclick="nextQuestion()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition duration-300">
                            Siguiente
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline ml-1" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                </div>
                
                <!-- Navegación rápida entre preguntas -->
                <div class="p-4 bg-gray-100 border-t border-gray-200">
                    <h3 class="text-sm font-semibold text-gray-700 mb-2">Navegación rápida:</h3>
                    <div id="question-nav" class="flex flex-wrap gap-2">
                        <!-- Los botones de navegación se generarán aquí -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let currentTest = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let startTime = null;
        let timerInterval = null;
        let completedTopics = new Array(20).fill(false);
        
        // Datos de preguntas (en una app real, esto vendría de una API)
        const questionsDatabase = generateQuestionsDatabase();
        
        // Navegación entre páginas
        function scrollToTopics() {
            document.getElementById('topics').scrollIntoView({ behavior: 'smooth' });
        }
        
        function backToMain() {
            document.getElementById('main-page').classList.remove('hidden');
            document.getElementById('test-page').classList.add('hidden');
            stopTimer();
            updateFinalTestButton();
        }
        
        function startTopicTest(topicNumber) {
            currentTest = {
                type: 'topic',
                topic: topicNumber,
                questions: getRandomQuestions(topicNumber, 20)
            };
            startTest();
        }
        
        function startFinalTest() {
            // Seleccionar 5 preguntas de cada tema (total 100)
            let finalQuestions = [];
            for (let i = 1; i <= 20; i++) {
                finalQuestions = finalQuestions.concat(getRandomQuestions(i, 5));
            }
            // Mezclar las preguntas
            finalQuestions = shuffleArray(finalQuestions);
            
            currentTest = {
                type: 'final',
                questions: finalQuestions
            };
            startTest();
        }
        
        function startTest() {
            // Resetear variables
            currentQuestionIndex = 0;
            userAnswers = new Array(currentTest.questions.length).fill(null);
            startTime = new Date();
            
            // Configurar la página de test
            document.getElementById('main-page').classList.add('hidden');
            document.getElementById('test-page').classList.remove('hidden');
            
            if (currentTest.type === 'topic') {
                document.getElementById('test-title').textContent = `Tema ${currentTest.topic}: ${topics[currentTest.topic - 1]}`;
            } else {
                document.getElementById('test-title').textContent = 'TEST FINAL (100 preguntas)';
            }
            
            // Iniciar timer
            startTimer();
            
            // Mostrar primera pregunta
            showQuestion();
            
            // Generar navegación rápida
            generateQuestionNavigation();
        }
        
        // Funciones para manejar el test
        function showQuestion() {
            const question = currentTest.questions[currentQuestionIndex];
            const questionContainer = document.getElementById('question-container');
            
            // Actualizar progreso
            document.getElementById('test-progress').textContent = 
                `Pregunta ${currentQuestionIndex + 1} de ${currentTest.questions.length}`;
            
            // Actualizar barra de progreso
            const progressPercent = ((currentQuestionIndex + 1) / currentTest.questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progressPercent}%`;
            
            // Actualizar contador de respuestas
            updateAnsweredCount();
            
            // Construir HTML de la pregunta
            let optionsHtml = '';
            question.options.forEach((option, index) => {
                const isSelected = userAnswers[currentQuestionIndex] === index;
                const optionClass = isSelected ? 
                    (option.correct ? 'correct' : 'incorrect') : '';
                
                optionsHtml += `
                    <div onclick="selectOption(${index})" 
                         class="test-option p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-purple-50 transition duration-200 ${optionClass}">
                        <span class="font-semibold">${String.fromCharCode(65 + index)})</span> ${option.text}
                    </div>
                `;
            });
            
            questionContainer.innerHTML = `
                <p class="text-lg mb-6">${question.text}</p>
                ${question.formula ? `<p class="text-2xl font-bold text-center mb-8 math-symbol">${question.formula}</p>` : ''}
                <div class="space-y-3">
                    ${optionsHtml}
                </div>
            `;
            
            // Actualizar botones de navegación
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            document.getElementById('next-btn').textContent = 
                currentQuestionIndex === currentTest.questions.length - 1 ? 'Finalizar' : 'Siguiente';
                
            // Actualizar navegación rápida
            updateQuestionNavigation();
        }
        
        function selectOption(optionIndex) {
            const question = currentTest.questions[currentQuestionIndex];
            userAnswers[currentQuestionIndex] = optionIndex;
            
            // Mostrar retroalimentación visual
            const options = document.querySelectorAll('.test-option');
            options.forEach((opt, idx) => {
                opt.classList.remove('correct', 'incorrect');
                if (question.options[idx].correct) {
                    opt.classList.add('correct');
                } else if (idx === optionIndex) {
                    opt.classList.add('incorrect');
                }
            });
            
            // Actualizar contador de respuestas
            updateAnsweredCount();
            
            // Actualizar navegación rápida
            updateQuestionNavigation();
        }
        
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
            }
        }
        
        function nextQuestion() {
            if (currentQuestionIndex < currentTest.questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
            } else {
                finishTest();
            }
        }
        
        function jumpToQuestion(index) {
            currentQuestionIndex = index;
            showQuestion();
        }
        
        function updateAnsweredCount() {
            const answered = userAnswers.filter(answer => answer !== null).length;
            document.getElementById('answered-count').textContent = 
                `${answered} de ${currentTest.questions.length} respondidas`;
        }
        
        function generateQuestionNavigation() {
            const navContainer = document.getElementById('question-nav');
            navContainer.innerHTML = '';
            
            currentTest.questions.forEach((_, index) => {
                const btn = document.createElement('button');
                btn.className = 'w-10 h-10 rounded-full border border-gray-300 text-sm font-medium transition duration-200';
                btn.textContent = index + 1;
                btn.onclick = () => jumpToQuestion(index);
                
                navContainer.appendChild(btn);
            });
            
            updateQuestionNavigation();
        }
        
        function updateQuestionNavigation() {
            const navButtons = document.querySelectorAll('#question-nav button');
            
            navButtons.forEach((btn, index) => {
                // Resetear clases
                btn.className = 'w-10 h-10 rounded-full border border-gray-300 text-sm font-medium transition duration-200';
                
                // Pregunta actual
                if (index === currentQuestionIndex) {
                    btn.classList.add('bg-purple-600', 'text-white', 'border-purple-700');
                } 
                // Preguntas respondidas
                else if (userAnswers[index] !== null) {
                    btn.classList.add('bg-purple-100', 'text-purple-800', 'border-purple-200', 'answered');
                }
                // Preguntas no respondidas
                else {
                    btn.classList.add('bg-white', 'text-gray-700', 'hover:bg-gray-50');
                }
            });
        }
        
        function finishTest() {
            // Calcular resultados
            const correctAnswers = currentTest.questions.reduce((count, question, index) => {
                const userAnswer = userAnswers[index];
                return count + (userAnswer !== null && question.options[userAnswer].correct ? 1 : 0);
            }, 0);
            
            const percentage = Math.round((correctAnswers / currentTest.questions.length) * 100);
            const timeSpent = Math.floor((new Date() - startTime) / 1000);
            const minutes = Math.floor(timeSpent / 60);
            const seconds = timeSpent % 60;
            
            // Si es un test de tema y el porcentaje es mayor a 70%, marcarlo como completado
            if (currentTest.type === 'topic' && percentage >= 70) {
                completedTopics[currentTest.topic - 1] = true;
                document.getElementById(`topic-${currentTest.topic}`).classList.add('completed-topic');
            }
            
            // Mostrar resultados
            document.getElementById('question-container').innerHTML = `
                <div class="text-center py-8">
                    <h3 class="text-2xl font-bold text-purple-800 mb-4">¡Test completado!</h3>
                    <div class="text-4xl font-bold mb-6 ${percentage >= 70 ? 'text-green-600' : 'text-red-600'}">
                        ${percentage}%
                    </div>
                    <p class="text-lg mb-2">Respuestas correctas: <span class="font-bold">${correctAnswers} de ${currentTest.questions.length}</span></p>
                    <p class="text-lg mb-6">Tiempo: <span class="font-bold">${minutes}m ${seconds}s</span></p>
                    
                    <button onclick="backToMain()" class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition duration-300">
                        Volver al temario
                    </button>
                </div>
            `;
            
            // Ocultar elementos de navegación
            document.getElementById('prev-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('question-nav').classList.add('hidden');
            document.getElementById('answered-count').classList.add('hidden');
            
            // Detener timer
            stopTimer();
        }
        
        // Timer functions
        function startTimer() {
            updateTimerDisplay();
            timerInterval = setInterval(updateTimerDisplay, 1000);
        }
        
        function stopTimer() {
            clearInterval(timerInterval);
        }
        
        function updateTimerDisplay() {
            const elapsed = Math.floor((new Date() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
            const seconds = (elapsed % 60).toString().padStart(2, '0');
            document.getElementById('test-timer').textContent = `Tiempo: ${minutes}:${seconds}`;
        }
        
        // Función para actualizar el estado del botón del test final
        function updateFinalTestButton() {
            const finalTestBtn = document.getElementById('final-test-btn');
            const allTopicsCompleted = completedTopics.every(topic => topic);
            
            if (allTopicsCompleted) {
                finalTestBtn.textContent = 'Comenzar Test →';
                finalTestBtn.className = 'bg-white text-purple-800 font-semibold py-2 px-4 rounded-full hover:bg-purple-100 transition duration-300';
                finalTestBtn.disabled = false;
                finalTestBtn.onclick = function() { startFinalTest(); };
            } else {
                const completedCount = completedTopics.filter(topic => topic).length;
                finalTestBtn.textContent = `Completa todos los temas primero (${completedCount}/20)`;
                finalTestBtn.className = 'bg-purple-200 text-purple-800 font-semibold py-2 px-4 rounded-full opacity-50 cursor-not-allowed';
                finalTestBtn.disabled = true;
                finalTestBtn.onclick = null;
            }
        }
        
        // Funciones auxiliares
        function getRandomQuestions(topicNumber, count) {
            const topicQuestions = questionsDatabase.filter(q => q.topic === topicNumber);
            return shuffleArray(topicQuestions).slice(0, count);
        }
        
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // Generador de preguntas con opciones numéricas relevantes
        function generateQuestionsDatabase() {
            const questions = [];
            const topicCounts = new Array(20).fill(0);
            
            // Generar 20 preguntas por cada tema (total 400 preguntas)
            for (let topic = 1; topic <= 20; topic++) {
                for (let i = 0; i < 20; i++) {
                    topicCounts[topic - 1]++;
                    const qNumber = topicCounts[topic - 1];
                    
                    // Crear pregunta básica con opciones
                    const question = {
                        id: `${topic}-${qNumber}`,
                        topic: topic,
                        text: `Pregunta ${qNumber} del Tema ${topic}: ${generateQuestionText(topic)}`,
                        formula: generateQuestionFormula(topic),
                        options: []
                    };
                    
                    // Generar 4 opciones numéricas (1 correcta)
                    const correctAnswer = generateCorrectAnswer(topic);
                    question.options.push({
                        text: correctAnswer,
                        correct: true
                    });
                    
                    // Generar 3 opciones incorrectas plausibles
                    for (let j = 0; j < 3; j++) {
                        question.options.push({
                            text: generateIncorrectAnswer(topic, correctAnswer),
                            correct: false
                        });
                    }
                    
                    // Mezclar las opciones
                    question.options = shuffleArray(question.options);
                    
                    questions.push(question);
                }
            }
            
            return questions;
        }
        
        // Funciones para generar contenido de preguntas con respuestas numéricas
        function generateQuestionText(topic) {
            const topics = [
                "¿Cuál es la integral indefinida de la siguiente función?",
                "Resuelve la integral después de aplicar los pasos algebraicos necesarios:",
                "Aplica un cambio de variable adecuado para resolver:",
                "Calcula la integral de la función exponencial:",
                "Resuelve la integral trigonométrica:",
                "Combina técnicas para resolver esta integral:",
                "Aplica integración por partes para resolver:",
                "Usa sustitución trigonométrica para integrar:",
                "Aplica fracciones parciales (caso 1) para resolver:",
                "Aplica fracciones parciales (caso 2) para resolver:",
                "Aplica fracciones parciales (caso 3) para resolver:",
                "Aplica fracciones parciales (caso 4) para resolver:",
                "Resuelve esta integral especial usando un truco:",
                "Resuelve esta integral avanzada que combina técnicas:",
                "Calcula la integral definida usando cambio de variable:",
                "Calcula el área bajo la curva de la función:",
                "Determina el área entre las dos funciones:",
                "Calcula el volumen del sólido de revolución usando discos:",
                "Calcula el volumen usando arandelas o capas cilíndricas:",
                "Resuelve este problema de tiro vertical usando integrales:"
            ];
            return topics[topic - 1] || "Resuelve la siguiente integral:";
        }
        
        function generateQuestionFormula(topic) {
            const formulas = [
                "∫x^n dx",
                "∫(3x² + 2x + 1)/(x + 1) dx",
                "∫cos(3x + 2) dx",
                "∫e^(5x) dx",
                "∫sin²(x)cos(x) dx",
                "∫(e^x + x³ + sin(x)) dx",
                "∫x·e^x dx",
                "∫√(9 - x²) dx",
                "∫(5x + 3)/(x² - 4) dx",
                "∫(x² + 1)/(x + 1)³ dx",
                "∫(2x + 3)/(x² + 4x + 5) dx",
                "∫(x³ + x + 1)/(x⁴ - 1) dx",
                "∫sin(x)cos(x) dx",
                "∫e^x sin(x) dx",
                "∫₀¹ x√(1 + x²) dx",
                "∫₀² (x² + 1) dx",
                "Área entre y = x² y y = √x",
                "Volumen al girar y = x² (0≤x≤2) alrededor de y=0",
                "Volumen al girar y = x² (0≤x≤1) alrededor de x=1",
                "v(t) = 50 - 9.8t (posición en t=5)"
            ];
            return formulas[topic - 1] || "∫f(x) dx";
        }
        
        function generateCorrectAnswer(topic) {
            // Genera respuestas correctas específicas para cada tema
            switch(topic) {
                case 1:  // Integrales inmediatas
                    return "x³/3 + C";
                case 2:  // Integrales con pasos algebraicos
                    return "3x²/2 - x + 4ln|x + 1| + C";
                case 3:  // Cambio de variable
                    return "sin(3x + 2)/3 + C";
                case 4:  // Función exponencial
                    return "e^(5x)/5 + C";
                case 5:  // Trigonométricas
                    return "sin³(x)/3 + C";
                case 6:  // Integrales combinadas
                    return "e^x + x⁴/4 - cos(x) + C";
                case 7:  // Integración por partes
                    return "e^x(x - 1) + C";
                case 8:  // Sustitución trigonométrica
                    return "9/2·arcsin(x/3) + x/2·√(9 - x²) + C";
                case 9:  // Fracciones parciales 1
                    return "7/4·ln|x - 2| + 13/4·ln|x + 2| + C";
                case 10: // Fracciones parciales 2
                    return "-2/(x + 1) + 3/(x + 1)² + ln|x + 1| + C";
                case 11: // Fracciones parciales 3
                    return "ln(x² + 4x + 5) - 5arctan(x + 2) + C";
                case 12: // Fracciones parciales 4
                    return "1/4·ln|x - 1| + 3/8·ln(x² + 1) + 5/4·arctan(x) + C";
                case 13: // Integrales especiales
                    return "-cos(2x)/4 + C";
                case 14: // Integrales avanzadas
                    return "e^x(sin(x) - cos(x))/2 + C";
                case 15: // Integral definida con cambio
                    return "(2√2 - 1)/3";
                case 16: // Área bajo curva
                    return "14/3";
                case 17: // Área entre curvas
                    return "1/3";
                case 18: // Volumen sólidos revolución (discos)
                    return "32π/5";
                case 19: // Volumen sólidos revolución (arandelas/capas)
                    return "5π/6";
                case 20: // Tiro vertical
                    return "127.5 m";
                default:
                    return "Respuesta correcta";
            }
        }
        
        function generateIncorrectAnswer(topic, correctAnswer) {
            // Genera respuestas incorrectas plausibles basadas en errores comunes
            const correctNum = parseFloat(correctAnswer) || 1;
            const variations = [
                correctNum * 0.5,
                correctNum * 2,
                correctNum + (Math.random() > 0.5 ? 1 : -1),
                correctNum / (Math.PI/2),
                correctNum * (Math.PI/2),
                correctNum + " + C",  // Para integrales definidas
                correctNum.toString().replace('+ C', ''),  // Olvidó la constante
                correctNum.toString().replace('/', '*')  // Error en operación
            ];
            
            // Seleccionar una variación aleatoria
            let incorrect = variations[Math.floor(Math.random() * variations.length)];
            
            // Para respuestas que incluyen texto (como " + C")
            if (typeof correctAnswer === 'string' && correctAnswer.includes('+ C')) {
                if (Math.random() > 0.5) {
                    incorrect += " + C";
                } else {
                    incorrect = incorrect.toString().replace('+ C', '');
                }
            }
            
            return incorrect.toString();
        }
        
        // Inicializar el botón del test final
        updateFinalTestButton();
    </script>
</body>
</html>